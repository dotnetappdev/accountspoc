@inject NavigationManager NavigationManager

<!-- Main Sidebar Container -->
<aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="/" class="brand-link">
        <i class="bi bi-calculator brand-image"></i>
        <span class="brand-text font-weight-light">AccountsPOC</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
        <!-- Sidebar user panel (optional) -->
        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
            <div class="image">
                <i class="bi bi-person-circle" style="font-size: 2rem; color: white;"></i>
            </div>
            <div class="info">
                <a href="#" class="d-block">Admin User</a>
            </div>
        </div>

        <!-- Sidebar Menu -->
        <nav class="mt-2">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                <!-- Dashboard -->
                <li class="nav-item">
                    <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                        <i class="nav-icon bi bi-speedometer2"></i>
                        <p>Dashboard</p>
                    </NavLink>
                </li>

                <!-- Sales & Orders -->
                <li class="nav-item @(expandedSections.Contains("sales") ? "menu-open" : "")">
                    <a href="#" class="nav-link" @onclick="@(() => ToggleSection("sales"))" @onclick:preventDefault>
                        <i class="nav-icon bi bi-cart-check"></i>
                        <p>
                            Sales & Orders
                            <i class="right bi @(expandedSections.Contains("sales") ? "bi-chevron-down" : "bi-chevron-right")"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="customers">
                                <i class="bi bi-people nav-icon"></i>
                                <p>Customers</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="sales-orders">
                                <i class="bi bi-cart3 nav-icon"></i>
                                <p>Sales Orders</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="sales-invoices">
                                <i class="bi bi-receipt nav-icon"></i>
                                <p>Sales Invoices</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="quotes">
                                <i class="bi bi-file-text nav-icon"></i>
                                <p>Quotes</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="price-lists">
                                <i class="bi bi-tags nav-icon"></i>
                                <p>Price Lists</p>
                            </NavLink>
                        </li>
                    </ul>
                </li>

                <!-- Work Orders -->
                <li class="nav-item @(expandedSections.Contains("workorders") ? "menu-open" : "")">
                    <a href="#" class="nav-link" @onclick="@(() => ToggleSection("workorders"))" @onclick:preventDefault>
                        <i class="nav-icon bi bi-wrench"></i>
                        <p>
                            Work Orders & Visits
                            <i class="right bi @(expandedSections.Contains("workorders") ? "bi-chevron-down" : "bi-chevron-right")"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="work-orders">
                                <i class="bi bi-clipboard-check nav-icon"></i>
                                <p>Work Orders</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="site-visits">
                                <i class="bi bi-calendar-check nav-icon"></i>
                                <p>Site Visits</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="site-visit-signoffs">
                                <i class="bi bi-pen nav-icon"></i>
                                <p>Visit Sign-offs</p>
                            </NavLink>
                        </li>
                    </ul>
                </li>

                <!-- Inventory Management -->
                <li class="nav-item @(expandedSections.Contains("inventory") ? "menu-open" : "")">
                    <a href="#" class="nav-link" @onclick="@(() => ToggleSection("inventory"))" @onclick:preventDefault>
                        <i class="nav-icon bi bi-boxes"></i>
                        <p>
                            Inventory
                            <i class="right bi @(expandedSections.Contains("inventory") ? "bi-chevron-down" : "bi-chevron-right")"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="products">
                                <i class="bi bi-box-seam nav-icon"></i>
                                <p>Products</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="stock-items">
                                <i class="bi bi-stack nav-icon"></i>
                                <p>Stock Items</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="warehouses">
                                <i class="bi bi-building nav-icon"></i>
                                <p>Warehouses</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="bill-of-materials">
                                <i class="bi bi-list-check nav-icon"></i>
                                <p>Bill of Materials</p>
                            </NavLink>
                        </li>
                    </ul>
                </li>

                <!-- Financial Management -->
                <li class="nav-item @(expandedSections.Contains("financial") ? "menu-open" : "")">
                    <a href="#" class="nav-link" @onclick="@(() => ToggleSection("financial"))" @onclick:preventDefault>
                        <i class="nav-icon bi bi-cash-stack"></i>
                        <p>
                            Finance
                            <i class="right bi @(expandedSections.Contains("financial") ? "bi-chevron-down" : "bi-chevron-right")"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="bank-accounts">
                                <i class="bi bi-bank2 nav-icon"></i>
                                <p>Bank Accounts</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="exchangerates">
                                <i class="bi bi-currency-exchange nav-icon"></i>
                                <p>Exchange Rates</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="tax-export">
                                <i class="bi bi-file-earmark-spreadsheet nav-icon"></i>
                                <p>Tax Export</p>
                            </NavLink>
                        </li>
                    </ul>
                </li>

                <!-- Forms -->
                <li class="nav-item">
                    <NavLink class="nav-link" href="forms" Match="NavLinkMatch.All">
                        <i class="nav-icon bi bi-ui-checks-grid"></i>
                        <p>Forms</p>
                    </NavLink>
                </li>

                <!-- Configuration & Settings -->
                <li class="nav-item @(expandedSections.Contains("settings") ? "menu-open" : "")">
                    <a href="#" class="nav-link" @onclick="@(() => ToggleSection("settings"))" @onclick:preventDefault>
                        <i class="nav-icon bi bi-gear"></i>
                        <p>
                            Configuration
                            <i class="right bi @(expandedSections.Contains("settings") ? "bi-chevron-down" : "bi-chevron-right")"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="settings">
                                <i class="bi bi-sliders nav-icon"></i>
                                <p>System Settings</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="branding">
                                <i class="bi bi-palette nav-icon"></i>
                                <p>Branding</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="configurationsettings">
                                <i class="bi bi-sliders2 nav-icon"></i>
                                <p>Configuration</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="custom-fields">
                                <i class="bi bi-input-cursor-text nav-icon"></i>
                                <p>Custom Fields</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="email-templates">
                                <i class="bi bi-envelope-open nav-icon"></i>
                                <p>Email Templates</p>
                            </NavLink>
                        </li>
                    </ul>
                </li>

                <!-- Payments & Integration -->
                <li class="nav-item @(expandedSections.Contains("integration") ? "menu-open" : "")">
                    <a href="#" class="nav-link" @onclick="@(() => ToggleSection("integration"))" @onclick:preventDefault>
                        <i class="nav-icon bi bi-plugin"></i>
                        <p>
                            Integrations
                            <i class="right bi @(expandedSections.Contains("integration") ? "bi-chevron-down" : "bi-chevron-right")"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="paymentproviderconfigs">
                                <i class="bi bi-credit-card-2-back nav-icon"></i>
                                <p>Payment Providers</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="apikeymanagement">
                                <i class="bi bi-key nav-icon"></i>
                                <p>API Keys</p>
                            </NavLink>
                        </li>
                    </ul>
                </li>

                <!-- User Management -->
                <li class="nav-item @(expandedSections.Contains("usermgmt") ? "menu-open" : "")">
                    <a href="#" class="nav-link" @onclick="@(() => ToggleSection("usermgmt"))" @onclick:preventDefault>
                        <i class="nav-icon bi bi-people-fill"></i>
                        <p>
                            User Management
                            <i class="right bi @(expandedSections.Contains("usermgmt") ? "bi-chevron-down" : "bi-chevron-right")"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="tenants">
                                <i class="bi bi-building nav-icon"></i>
                                <p>Tenants</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="users">
                                <i class="bi bi-person nav-icon"></i>
                                <p>Users</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="roles">
                                <i class="bi bi-shield-check nav-icon"></i>
                                <p>Roles</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="permissions">
                                <i class="bi bi-lock nav-icon"></i>
                                <p>Permissions</p>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="licenses">
                                <i class="bi bi-key-fill nav-icon"></i>
                                <p>Licenses</p>
                            </NavLink>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
</aside>

@code {
    private HashSet<string> expandedSections = new() { "sales", "inventory" }; // Default expanded sections

    private void ToggleSection(string sectionName)
    {
        if (expandedSections.Contains(sectionName))
        {
            expandedSections.Remove(sectionName);
        }
        else
        {
            expandedSections.Add(sectionName);
        }
    }
}
