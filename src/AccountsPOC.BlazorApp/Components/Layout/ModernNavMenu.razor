@inject NavigationManager NavigationManager

<div class="modern-sidebar">
    <div class="sidebar-header">
        <div class="logo">
            <i class="bi bi-calculator"></i>
            <span class="logo-text">Accounts</span>
        </div>
    </div>

    <nav class="sidebar-nav">
        <!-- Dashboard -->
        <NavLink class="nav-item" href="" Match="NavLinkMatch.All">
            <i class="bi bi-speedometer2"></i>
            <span>Dashboard</span>
        </NavLink>

        <!-- Sales & Orders -->
        <div class="nav-section">
            <button class="section-header" @onclick="@(() => ToggleSection("sales"))">
                <div class="section-title">
                    <i class="bi bi-cart-check"></i>
                    <span>Sales & Orders</span>
                </div>
                <i class="bi @(expandedSections.Contains("sales") ? "bi-chevron-down" : "bi-chevron-right")"></i>
            </button>
            <div class="section-items @(expandedSections.Contains("sales") ? "expanded" : "")">
                <NavLink class="nav-item sub-item" href="customers">
                    <i class="bi bi-people"></i>
                    <span>Customers</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="sales-orders">
                    <i class="bi bi-cart3"></i>
                    <span>Sales Orders</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="sales-invoices">
                    <i class="bi bi-receipt"></i>
                    <span>Sales Invoices</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="price-lists">
                    <i class="bi bi-tags"></i>
                    <span>Price Lists</span>
                </NavLink>
            </div>
        </div>

        <!-- Inventory Management -->
        <div class="nav-section">
            <button class="section-header" @onclick="@(() => ToggleSection("inventory"))">
                <div class="section-title">
                    <i class="bi bi-boxes"></i>
                    <span>Inventory</span>
                </div>
                <i class="bi @(expandedSections.Contains("inventory") ? "bi-chevron-down" : "bi-chevron-right")"></i>
            </button>
            <div class="section-items @(expandedSections.Contains("inventory") ? "expanded" : "")">
                <NavLink class="nav-item sub-item" href="products">
                    <i class="bi bi-box-seam"></i>
                    <span>Products</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="stock-items">
                    <i class="bi bi-stack"></i>
                    <span>Stock Items</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="warehouses">
                    <i class="bi bi-building"></i>
                    <span>Warehouses</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="bill-of-materials">
                    <i class="bi bi-list-check"></i>
                    <span>Bill of Materials</span>
                </NavLink>
            </div>
        </div>

        <!-- Financial Management -->
        <div class="nav-section">
            <button class="section-header" @onclick="@(() => ToggleSection("financial"))">
                <div class="section-title">
                    <i class="bi bi-cash-stack"></i>
                    <span>Finance</span>
                </div>
                <i class="bi @(expandedSections.Contains("financial") ? "bi-chevron-down" : "bi-chevron-right")"></i>
            </button>
            <div class="section-items @(expandedSections.Contains("financial") ? "expanded" : "")">
                <NavLink class="nav-item sub-item" href="bank-accounts">
                    <i class="bi bi-bank2"></i>
                    <span>Bank Accounts</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="exchangerates">
                    <i class="bi bi-currency-exchange"></i>
                    <span>Exchange Rates</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="tax-export">
                    <i class="bi bi-file-earmark-spreadsheet"></i>
                    <span>Tax Export</span>
                </NavLink>
            </div>
        </div>

        <!-- Configuration & Settings -->
        <div class="nav-section">
            <button class="section-header" @onclick="@(() => ToggleSection("settings"))">
                <div class="section-title">
                    <i class="bi bi-gear"></i>
                    <span>Configuration</span>
                </div>
                <i class="bi @(expandedSections.Contains("settings") ? "bi-chevron-down" : "bi-chevron-right")"></i>
            </button>
            <div class="section-items @(expandedSections.Contains("settings") ? "expanded" : "")">
                <NavLink class="nav-item sub-item" href="settings">
                    <i class="bi bi-sliders"></i>
                    <span>System Settings</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="configurationsettings">
                    <i class="bi bi-sliders2"></i>
                    <span>Configuration</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="custom-fields">
                    <i class="bi bi-input-cursor-text"></i>
                    <span>Custom Fields</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="email-templates">
                    <i class="bi bi-envelope-open"></i>
                    <span>Email Templates</span>
                </NavLink>
            </div>
        </div>

        <!-- Payments & Integration -->
        <div class="nav-section">
            <button class="section-header" @onclick="@(() => ToggleSection("integration"))">
                <div class="section-title">
                    <i class="bi bi-plugin"></i>
                    <span>Integrations</span>
                </div>
                <i class="bi @(expandedSections.Contains("integration") ? "bi-chevron-down" : "bi-chevron-right")"></i>
            </button>
            <div class="section-items @(expandedSections.Contains("integration") ? "expanded" : "")">
                <NavLink class="nav-item sub-item" href="paymentproviderconfigs">
                    <i class="bi bi-credit-card-2-back"></i>
                    <span>Payment Providers</span>
                </NavLink>
                <NavLink class="nav-item sub-item" href="apikeymanagement">
                    <i class="bi bi-key"></i>
                    <span>API Keys</span>
                </NavLink>
            </div>
        </div>
    </nav>
</div>

@code {
    private HashSet<string> expandedSections = new() { "sales", "inventory" }; // Default expanded sections

    private void ToggleSection(string sectionName)
    {
        if (expandedSections.Contains(sectionName))
        {
            expandedSections.Remove(sectionName);
        }
        else
        {
            expandedSections.Add(sectionName);
        }
    }
}
